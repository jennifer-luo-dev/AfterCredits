{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 82, "column": 0}, "map": {"version":3,"sources":["file:///Users/jennifer/personalprojects/AfterCredits/aftercredits/src/app/api/storage/check-bucket/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\nimport { createClient as createSupabaseClient } from \"@supabase/supabase-js\";\n\nconst SUPABASE_URL = process.env.NEXT_PUBLIC_SUPABASE_URL;\nconst SUPABASE_SERVICE_ROLE_KEY = process.env.SUPABASE_SERVICE_ROLE_KEY;\nconst supabaseAdmin =\n  SUPABASE_URL && SUPABASE_SERVICE_ROLE_KEY\n    ? createSupabaseClient(SUPABASE_URL, SUPABASE_SERVICE_ROLE_KEY)\n    : null;\n\nexport async function GET(request: Request) {\n  const url = new URL(request.url);\n  let bucket = url.searchParams.get(\"bucket\") ?? \"memories\";\n  // sanitize bucket in case it was provided with surrounding quotes\n  if (typeof bucket === \"string\") {\n    bucket = bucket.trim().replace(/^\\\"+|\\\"+$/g, \"\");\n  }\n\n  if (!supabaseAdmin)\n    return NextResponse.json({ error: \"service key not configured\" }, { status: 500 });\n\n  try {\n    // Attempt to list objects in the bucket; if the bucket doesn't exist, Supabase returns an error\n    // Note: `list()` signature is list(path?: string, opts?: { limit, offset, sortBy })\n    // so pass an explicit empty prefix and options object to avoid passing the\n    // options object as the path (which causes \"body/prefix must be string\").\n    const { data, error } = await supabaseAdmin.storage.from(bucket).list(\"\", { limit: 1 });\n    if (error) {\n      console.warn(\"check-bucket supabase error:\", error);\n      return NextResponse.json({ exists: false, error: error.message }, { status: 200 });\n    }\n    return NextResponse.json({ exists: true });\n  } catch (err: any) {\n    console.error(\"check-bucket failed:\", err?.message ?? err);\n    return NextResponse.json({ exists: false, error: err?.message ?? \"failed to check bucket\" }, { status: 500 });\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEA,MAAM;AACN,MAAM,4BAA4B,QAAQ,GAAG,CAAC,yBAAyB;AACvE,MAAM,gBACJ,gBAAgB,4BACZ,IAAA,6PAAoB,EAAC,cAAc,6BACnC;AAEC,eAAe,IAAI,OAAgB;IACxC,MAAM,MAAM,IAAI,IAAI,QAAQ,GAAG;IAC/B,IAAI,SAAS,IAAI,YAAY,CAAC,GAAG,CAAC,aAAa;IAC/C,kEAAkE;IAClE,IAAI,OAAO,WAAW,UAAU;QAC9B,SAAS,OAAO,IAAI,GAAG,OAAO,CAAC,cAAc;IAC/C;IAEA,IAAI,CAAC,eACH,OAAO,oMAAY,CAAC,IAAI,CAAC;QAAE,OAAO;IAA6B,GAAG;QAAE,QAAQ;IAAI;IAElF,IAAI;QACF,gGAAgG;QAChG,oFAAoF;QACpF,2EAA2E;QAC3E,0EAA0E;QAC1E,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,cAAc,OAAO,CAAC,IAAI,CAAC,QAAQ,IAAI,CAAC,IAAI;YAAE,OAAO;QAAE;QACrF,IAAI,OAAO;YACT,QAAQ,IAAI,CAAC,gCAAgC;YAC7C,OAAO,oMAAY,CAAC,IAAI,CAAC;gBAAE,QAAQ;gBAAO,OAAO,MAAM,OAAO;YAAC,GAAG;gBAAE,QAAQ;YAAI;QAClF;QACA,OAAO,oMAAY,CAAC,IAAI,CAAC;YAAE,QAAQ;QAAK;IAC1C,EAAE,OAAO,KAAU;QACjB,QAAQ,KAAK,CAAC,wBAAwB,KAAK,WAAW;QACtD,OAAO,oMAAY,CAAC,IAAI,CAAC;YAAE,QAAQ;YAAO,OAAO,KAAK,WAAW;QAAyB,GAAG;YAAE,QAAQ;QAAI;IAC7G;AACF"}}]
}